<!-- breadcrumb start -->
<div class="breadcrumb-section">
    <div class="container">
        <div class="row">
            <div class="col-sm-6">
                <div class="page-title">
                    <h2>Checkout</h2>
                </div>
            </div>
            <div class="col-sm-6">
                <nav aria-label="breadcrumb" class="theme-breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a [routerLink]="'/home'">Home</a></li>
                        <li class="breadcrumb-item active" aria-current="page">Checkout</li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>
</div>
<div class="container text-center position-fixed-loader" *ngIf="loader">
    <div class="load">
        <mat-spinner class="loader m-auto"></mat-spinner>
        <p class="mt-1 mb-0"><small><b>Loading..</b></small></p>
    </div>
    
  </div>
<!-- breadcrumb End -->
<section class="section-b-space" [ngClass]="{'disabled': loader}">
    <div class="container padding-cls">
        <div class="checkout-page">
            <div class="checkout-form">
                <form>
                    <div class="row">
                        <div class="col-lg-6 col-md-12 col-sm-12">
                            <div class="checkout-title">
                                <h3>Delivery Address</h3>
                            </div>
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="address-item">
                                        <i  [routerLink]="['/address/shop']" class="fa fa-pencil-square-o" *ngIf="!paid" aria-hidden="true"></i>
                                        <p class="name">{{showAddress?.fullName}}</p>
                                        <p class="address">
                                            {{showAddress?.address1}},<br>{{showAddress?.address2}},<br>City : {{showAddress?.city}}, State : {{showAddress?.state}},<br>Country : {{showAddress?.country}}, Pin : {{showAddress?.postalCode}}
                                        </p>
                                        <p class="phone">Landmark: {{showAddress?.landmark}}</p>
                                        <p class="phone">Mobile: {{showAddress?.mobile}}</p>
                                    </div>
                                </div>
                            </div>
                            <div class="checkout-title">
                                <h3>Payment</h3>
                            </div>
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="address-item radio-container">
                                        <div class="radio-custom-outer">
                                            <div class="radio-custom-label"> 
                                                <label>
                                                  <input type="radio" id="pay_by_online" value="ONLINE" name="payment_type" [(ngModel)]="model.payment_type" (change)="onChangePaymentMode(model.payment_type)" required checked="checked"> 
                                                  <div  class="btn btn-sık" matRipple><span>Payment by Online</span></div> 
                                                </label>
                                                <!-- <label class="disabled">
                                                    <input  type="radio"  id="pay_on_cash" value="CASH" name="payment_type" [(ngModel)]="model.payment_type" (change)="onChangePaymentMode(model.payment_type)" required> 
                                                  <div class="btn btn-sık" matRipple><span>Payment by Cash</span></div>
                                                </label> -->
                                                
                                            </div>
                                        </div>
                                    </div>
                                    <!-- <p><small>Payment by Cash in progress.</small></p> -->
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-6 col-md-12 col-sm-12">
                            <div class="checkout-title">
                                <h3>Products</h3>
                            </div>
                            <div class="order-box">
                                <ul class="qty" *ngIf='cartListData.length'>
                                    <li *ngFor="let cartItem of cartListData; index as i;">
                                        <div class="order-cart-item">
                                            <div class="item-img">
                                                <div class="img">
                                                    <img  [src]="cartItem?.images[0].large ? cartItem?.images[0].large : assets/images/no-bg-img.jpg">
                                                </div>
                                            </div>
                                            <div class="item-desc">
                                                <p class="designerName">Designer: {{cartItem?.designerProfile?.firstName1}}&nbsp;{{cartItem?.designerProfile?.lastName1}}</p>
                                                <p class="itemName">{{cartItem?.productDetails?.productName}}</p>
                                                <table>
                                                    <tbody>
                                                        <tr>
                                                            <td>
                                                                Size : {{cartItem?.selectedSize}}
                                                            </td>
                                                            <td>
                                                                Quantity : {{cartItem?.cartData?.qty}}
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <!-- <td>
                                                                ₹{{(cartItem?.deal?.salePrice * 0.18 + cartItem?.deal?.salePrice) * cartItem?.cartData?.qty | number: '1.0-0'}} <del>₹{{(cartItem?.mrp * 0.18 + cartItem?.mrp) * cartItem?.cartData?.qty}}</del>
                                                            </td> -->
                                                            <td *ngIf="cartItem?.deal?.salePrice || cartItem?.deal?.salePrice == 0">
                                                                ₹{{cartItem?.deal?.salePrice * cartItem?.cartData?.qty}}
                                                            </td>
                                                            <td *ngIf="!cartItem?.deal?.salePrice && cartItem?.deal?.salePrice != 0">
                                                                ₹{{cartItem?.mrp * cartItem?.cartData?.qty}}
                                                            </td>
                                                            <td>
                                                                <span *ngIf="showAddress?.state == cartItem?.designerProfile?.state" class="font-10 float-left w-100">CGST : {{cartItem?.deal?.taxAmount?.cgst}}% &nbsp;&nbsp;SGST : {{cartItem?.deal?.taxAmount?.cgst}}%</span>
                                                                <span *ngIf="showAddress?.state != cartItem?.designerProfile?.state" class="font-10 float-left w-100">IGST : {{cartItem?.deal?.taxAmount?.igst}}%</span>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td >
                                                                <div class="toggle-btn-content" *ngIf="cartItem?.withDesignCustomization" [ngClass]="{'disabledClick': paid}">
                                                                    <span class="product-text-size">Design customization : </span>
                                                                    <div class="on-off-toggle" *ngIf="orderProducts[i]?.customizationStatus">
                                                                        <input [disabled]="paid" class="on-off-toggle__input" type="checkbox" [checked]="orderProducts[i].customizationStatus"
                                                                        [id]="i+1"
                                                                        (click)="toggleChange('false',orderpack,cartItem,'customization',i)" />
                                                                        <label [for]="i+1" class="on-off-toggle__slider"></label>
                                                                    </div>
                                                                    <div class="on-off-toggle" *ngIf="!orderProducts[i]?.customizationStatus" [ngClass]="{'disabledClick': paid}">
                                                                        <input [disabled]="paid" class="on-off-toggle__input" type="checkbox" />
                                                                        <label  class="on-off-toggle__slider" (click)="toggleChange('true',orderpack,cartItem,'customization',i)"></label>
                                                                    </div>
                                                                    <!-- <mat-icon class="curser-pointer" *ngIf="!orderProducts[i].customizationStatus" (click)="toggleChange('true',orderpack,cartItem,'customization',i)">add</mat-icon> -->
                                                                </div>
                                                            </td>
                                                            <td>
                                                                <div class="toggle-btn-content pb-0" *ngIf="cartItem?.withGiftWrap" [ngClass]="{'disabledClick': paid}">
                                                                    <span class="product-text-size">Gift Wrap : </span>
                                                                    <div class="on-off-toggle" *ngIf="orderProducts[i]?.giftwrapStatus">
                                                                        <input class="on-off-toggle__input" type="checkbox" [disabled]="paid"
                                                                        [id]="cartItem?.productId"
                                                                        [checked]="orderProducts[i].giftwrapStatus"
                                                                        (click)="toggleChange('false',giftwrap,cartItem,'giftwrap',i)"
                                                                         />
                                                                        <label [for]="cartItem?.productId" class="on-off-toggle__slider"></label>
                                                                    </div>
                                                                    <div class="on-off-toggle" *ngIf="!orderProducts[i]?.giftwrapStatus" [ngClass]="{'disabledClick': paid}">
                                                                        <input class="on-off-toggle__input" type="checkbox" [disabled]="paid"/>
                                                                        <label  class="on-off-toggle__slider"  (click)="toggleChange('true',giftwrap,cartItem,'giftwrap',i)"></label>
                                                                    </div>
                                                                    <!-- <mat-icon class="curser-pointer" *ngIf="!orderProducts[i].giftwrapStatus" (click)="toggleChange('true',giftwrap,cartItem,'giftwrap',i)">add</mat-icon> -->
                                                                </div>
                                                                <span class="font-10 float-left w-100" *ngIf="cartItem?.withGiftWrap">Gift Wrap Amount : ₹{{cartItem?.giftWrapAmount}}</span>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                                <ul class="qty" *ngIf='!cartListData.length'>
                                    <li class="empty-checkout"> There are no products in cart </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                </form>
            </div>
            <div class="position-fixed cart-btn-section">
                <div class="total_price d-flex align-items-center">
                  <div class="price d-grid"> 
                    <div class="w-100 font-10">
                      <!-- <span>Total:</span><span class="float-right"> ₹{{ gsttax }}</span> -->
                      <span>Total:</span><span class="float-right"> ₹{{ total | number: '1.0-0'}}</span>
                    </div>
                    
                    <!-- <p class="font-10 mb-1 text-right">GST include 12%</p> -->
                    <p class="font-10 m-0">* EXCL SHIPPING COST</p>
                  </div>
                  
                  <div class="btnBox" *ngIf='cartListData.length'>
                    <a [ngClass]="{'disabled': !paymentType, 'disabledClick' : btnLoader}" (click)="checkout()" class="btn btn-solid d-flex align-items-center"><mat-spinner class="mini" *ngIf="btnLoader"></mat-spinner>&nbsp;Checkout</a>
                  </div>
                </div>
              </div>
        </div>
    </div>
    <ng-template #orderpack let-modal>
        <div class="packed_modal">
            <div class="modal-header">
                <h4 class="modal-title" id="modal-basic-title">Design customization</h4>
                <button type="button" class="close" aria-label="Close" (click)="closeModal('customization')">
                    <i class="fa fa-times" aria-hidden="true"></i>
                </button>
            </div>
              <form #customizationForm="ngForm" (ngSubmit)="ordersCustomizationSubmit(customizationForm)">
                <div class="modal-body">
                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <div class="form-group">
                                <mat-form-field class="example-full-width" appearance="outline">
                                  <mat-label>Customization Details</mat-label>
                                  <textarea  matInput required name="customizationDetails" [(ngModel)]="model.customizationDetails" ></textarea>
                                </mat-form-field>
                            </div>
                          </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-outline-dark submit-btn" [disabled]="!customizationForm.valid">Submit</button>
                </div>
              </form>
        </div>
    </ng-template>
    <ng-template #giftwrap let-modal>
        <div class="packed_modal">
            <div class="modal-header">
                <h4 class="modal-title" id="modal-basic-title">Gift Wrap</h4>
                <button type="button" class="close" aria-label="Close" (click)="closeModal('giftwrap')">
                    <i class="fa fa-times" aria-hidden="true"></i>
                </button>
            </div>
              <form #packedForm="ngForm" (ngSubmit)="ordersGiftSubmit(packedForm)">
                <div class="modal-body">
                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <div class="form-group">
                                <mat-form-field class="example-full-width" appearance="outline">
                                  <mat-label>From</mat-label>
                                  <input type="text" matInput required name="from" [(ngModel)]="model.from" >
                                </mat-form-field>
                            </div>
                          </div>
                          <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <div class="form-group">
                                <mat-form-field class="example-full-width" appearance="outline">
                                  <mat-label>To</mat-label>
                                  <input type="text" matInput required name="to" [(ngModel)]="model.to" >
                                </mat-form-field>
                            </div>
                          </div>
                          <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <div class="form-group">
                                <mat-form-field class="example-full-width" appearance="outline">
                                  <mat-label>Message</mat-label>
                                  <textarea  matInput required name="message" [(ngModel)]="model.message" rows="4"></textarea>
                                </mat-form-field>
                            </div>
                          </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-outline-dark submit-btn" [disabled]="!packedForm.valid">Submit</button>
                </div>
              </form>
        </div>
    </ng-template>
</section>

